---
title: "マルウェア"
---


Warez
- 非合法的に配布・販売されている商用ソフトウェア
- 日本では「ワレズ」と呼び、それが派生して「割れ」となった

WannaCry
- マルウェアの1種で
- EternalBlue

システム管理ツール PowerShell, PsExec
ペネトレーションテストツール Cobalt Strike Beacon
クラウドサービス Dropbox, OneDrive

ファイル転送用アプライアンス Accellion FTA を用いて企業の秘密情報を公開する。

## ソースコードでの難読化
### Win32API Hashing Obfuscation
Win32API名のHash値を使い、PEBから関数ポインタを探し、API呼び出しを行うことで、プログラムが使用するAPIを難読化。

## コンパイルで生成された中間表現での難読化
### Mixed Boolean Arithmetic
定数値/変数の初期値と同値となるような算術演算とビット演算の組み合わせ(XOR,ShiftLeft,ShiftRight,Addなど)に置換し、データを難読化。
### String Obfuscation
文字列をXORエンコードし、バイナリ内に格納。文字列の利用時のみにHeap領域へ復号。XOR-keyは文字列ごと/検体ごとに異なる。
Hikari
### Control Flow Flattening
ジャンプテーブルを作成し、制御フローを平坦化し、BasicBlockの実行順を難読化。実行順制御にはRouting変数を用いる。
oLLVMを用いてできる。
### Split Basic Blocks
Control Flow FlattenやString Obfuscationをより難読化する為にBasicBlockの分割をする。oLLVM
### Bogus Control Flow
Control Flow FlattenやString Obfuscation + Split Basic Blocksで生成された多数のBasic Blockに一意に決まるかつ削除が困難な条件分岐を追加しロジックを複雑化。Hikari
### Function Argument Randomization
関数コールの引数に不必要な定数と追加し、引数の順番を入れ替える。追加された引数はプログラムの動作には無関係であり、呼び出し元の関数のスタックに保持される。

[HikariObfuscator/Hikari: LLVM Obfuscator (github.com)](https://github.com/HikariObfuscator/Hikari)
[Home · obfuscator-llvm/obfuscator Wiki (github.com)](https://github.com/obfuscator-llvm/obfuscator/wiki)

おもろかった [JSAC2022 Emotet vs EmoCheck Emotet開発者との戦い - YouTube](https://www.youtube.com/watch?v=_XX8N5VbW2w)
[Objective-See's Mac Malware Collection](https://objective-see.org/malware.html)
